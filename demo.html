<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>CanvasPlot Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="dep/canvasplot.css">
  <script src="dep/jquery-2.2.3.min.js" charset="utf-8"></script>
  <script src="dep/d3.min.js" charset="utf-8"></script>
  <script src="dep/canvasplot.js" charset="utf-8"></script>
  <script src="dep/canvasplot-indicator-ts.js" charset="utf-8"></script>
  <script src="teead-viz.js" charset="utf-8"></script>
</head>
<body>

  <div>
    <input type="file" id="file" name="file" />
  </div>

<div id="maincontainer">

</div>

<script type="text/javascript">
function getDemoPlotSize() {
	return [window.innerWidth-100, Math.round(0.45*(window.innerWidth-100))];
}

$(document).ready(function() {
	var visualization = new TeeAdViz(d3.select("#maincontainer"), {
    thresholds: [-0.2, 1.2]
  });

  $('#file').change(function(evt) {
    var file = evt.target.files[0];
    var reader = new FileReader();
    reader.onload = function(e) {
        var dataSets = $.parseJSON(e.target.result);
        visualization.setMeasurements(dataSets);
    };
    reader.readAsText(file);
  });

  visualization.setMeasurements([]);
  setInterval(requestNewData, 1000);
  function requestNewData() {
    visualization.addMeasurements([
      {
        "time": new Date().getTime(),
        "measurement": 2500 * Math.random(),
        "prediction": 3000 * Math.random(),
        "anomalyscore": 5 * Math.random()
      },
      {
        "time": new Date().getTime() + 100,
        "measurement": 2500 * Math.random(),
        "prediction": 3000 * Math.random(),
        "anomalyscore": 5 * Math.random()
      }
    ]);
  }

});
</script>
</body>
</html>
